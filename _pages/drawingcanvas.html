---
layout: default
permalink: /DrawingCanvas
title: "Drawing Canvas"
excerpt: "Drawing Canvas"
    
---

<!-- https://medium.com/@joehanson/multi-user-javascript-virtual-whiteboard-28e4b24ef3e2 -->

Color: <input type="color" id="colorpicker" name="colorpicker" value="#ff0000">
<br><br>

<canvas id="drawCanvas" width="800" height="600" style="border:1px solid #000000;"></canvas>

<br><br>
<table border="0" cellpadding="0" cellspacing="0" style="padding:0px;">
<tr style="padding:0px;">
<td style="padding:0px;">
<canvas id="canvascolor1" width="60" height="100" style="border:1px solid #000000;"></canvas>
</td>
<td style="padding:0px;">
<canvas id="canvascolor2" width="60" height="100" style="border:1px solid #000000;"></canvas>
</td>
<td style="padding:0px;">
<canvas id="canvascolor3" width="60" height="100" style="border:1px solid #000000;"></canvas>
</td>
<td style="padding:0px;">
<canvas id="canvascolor4" width="60" height="100" style="border:1px solid #000000;"></canvas>
</td>
<td style="padding:0px;">
<canvas id="canvascolor5" width="60" height="100" style="border:1px solid #000000;"></canvas>
</td>
<td style="padding:0px;">
<canvas id="canvascolor6" width="60" height="100" style="border:1px solid #000000;"></canvas>
</td>
<td style="padding:0px;">
<canvas id="canvascolor7" width="60" height="100" style="border:1px solid #000000;"></canvas>
</td>
<td style="padding:0px;">
<canvas id="canvascolor8" width="60" height="100" style="border:1px solid #000000;"></canvas>
</td>
<td style="padding:0px;">
<canvas id="canvascolor9" width="60" height="100" style="border:1px solid #000000;"></canvas>
</td>
<td style="padding:0px;">
<canvas id="canvascolor10" width="60" height="100" style="border:1px solid #000000;"></canvas>
</td>
<td style="padding:0px;">
<canvas id="canvascolor11" width="60" height="100" style="border:1px solid #000000;"></canvas>
</td>
<td style="padding:0px;">
<canvas id="canvascolor12" width="60" height="100" style="border:1px solid #000000;"></canvas>
</td>
</tr>
</table>

<script type="text/javascript">
var canvas = document.getElementById('drawCanvas');
var ctx = canvas.getContext('2d');
var colorpicker = document.getElementById('colorpicker');

ctx.lineWidth = '3';

// ***** OPTION: GRID SUPPORT *****
// for labeling the grid
var xlabels = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
var ylabels = "123456789";

// palettes for pre made color choosers
var palettes = ['#f39a4f', '#eb6092', '#4ab6d9', '#abcc51', '#f9c847', '#75be6f', '#b6d051', '#bcddc7', '#a7cbeb', '#86b8e6', '#000000', '#ffffff' ];

var gridwidth = 100;
var gridheight = 75;

function gridListeners() {
    canvas.addEventListener('mousedown', fillgrid, false);
}

// call this to initialize the grid
makeGrid(canvas.width, canvas.height, gridwidth, gridheight);

// call this to add click listener to fill in rectangle
gridListeners();

// call this to initalize the color choosers
makeColorPalettes();

function colorpaletteclicked(e) {
    var id = e.target.id;
    
    id = id.replace("canvascolor", "");
    
    id = parseInt(id);
    
    chosencolor = palettes[id - 1];
    
    colorpicker.value = chosencolor;
    
    //console.log(id);
    //console.log(chosencolor);
}

function makeColorPalettes() {
    for(var i = 1; i <= palettes.length; i++) {
        var colorcanvas = document.getElementById('canvascolor' + i);
        makeColorPalette(colorcanvas, palettes[i-1], i);
        
        // Add a listener here that, when clicked, sets the main color picker color value
        colorcanvas.addEventListener('mousedown', colorpaletteclicked, false);        
    }
}

function makeColorPalette(colorcanvas, fillcolor, label) {
    var colorctx = colorcanvas.getContext('2d');
    
    // Color it in with the predefined palette
    colorctx.fillStyle = fillcolor;
    colorctx.fillRect(0, 0, colorcanvas.width, colorcanvas.height);
    
    // Label the color with a number
    colorctx.font = "18px Arial";
    if(fillcolor == '#000000') {
        colorctx.fillStyle = "white";    
        colorctx.strokeStyle = "white";         
    } else {
        colorctx.fillStyle = "black";    
        colorctx.strokeStyle = "black"; 
    }
    colorctx.fillText(label, (colorcanvas.width / 2.0) * 0.9, (colorcanvas.height / 2.0) * 0.9);
}

// https://stackoverflow.com/questions/11735856/draw-grid-table-on-canvas-html5
// bwidth/bheight is the dimension of the canvas board, and rwidth/rheight is the dimension of the rectangle in the grid
function makeGrid(bwidth, bheight, rwidth, rheight) {
    ctx.strokeStyle = "black";
    
    for (var x = 0; x <= bwidth; x += rwidth) {
        ctx.moveTo(x, 0);
        ctx.lineTo(x, bheight);
    }

    for (var y = 0; y <= bheight; y += rheight) {
        ctx.moveTo(0, y);
        ctx.lineTo(bwidth, y);
    }
    
    ctx.font = "18px Arial";
    var xi = 0;
    var yi = 0;
    for(var x = 0; x <= bwidth; x += rwidth) {
        yi = 0;
        
        for(var y = 0; y <= bheight; y += rheight) {
            label = xlabels.charAt(xi % xlabels.length) + ylabels.charAt(yi % ylabels.length);
            ctx.fillText(label, x + (rwidth / 2.0) - (rwidth / 10.0), y + (rheight / 2.0) - (rheight / 10.0));
            
            yi = yi + 1;
        }
        
        xi = xi + 1;
    }

    ctx.stroke();
}

function fillgrid(e) {
    // cross-browser canvas coordinates
    var x = e.offsetX || e.layerX - canvas.offsetLeft;
    var y = e.offsetY || e.layerY - canvas.offsetTop;
    
    // What grid rectangle are we in?
    var leftx = Math.floor(x * 1.0 / gridwidth) * gridwidth;
    var topy = Math.floor(y * 1.0 / gridheight) * gridheight;
    
    ctx.fillStyle = colorpicker.value;
    
    // Fill in that rectangle
    ctx.fillRect(leftx,topy,gridwidth,gridheight);
}
// ***** END OPTION: GRID SUPPORT *****

// ***** OPTION: FREE DRAW SUPPORT *****
// create a flag for free drawing (if pen is on or off)
var isActive = false;

// array to collect coordinates for free drawing
var plots = [];

function freeDrawListeners() {
    canvas.addEventListener('mousedown', startDraw, false);
    canvas.addEventListener('mousemove', draw, false);
    canvas.addEventListener('mouseup', endDraw, false);
}

// call this to add free draw listeners to attach the pen to the mouse
// freeDrawListeners();

function drawOnCanvas() {
  //console.log(plots[0].x);
  //console.log(plots[0].y);
  
  color = colorpicker.value;
  
  //console.log(color);
  
  ctx.strokeStyle = color;
  
  ctx.beginPath();
  ctx.moveTo(plots[0].x, plots[0].y);

  for(var i=1; i<plots.length; i++) {
    ctx.lineTo(plots[i].x, plots[i].y);
  }
  ctx.stroke();
}

function draw(e) {
  if(!isActive) return;

  // cross-browser canvas coordinates
  var x = e.offsetX || e.layerX - canvas.offsetLeft;
  var y = e.offsetY || e.layerY - canvas.offsetTop;

  plots.push({x: x, y: y});
  
  drawOnCanvas();
}

function startDraw(e) {
  isActive = true;
}

function endDraw(e) {
  isActive = false;

  // empty the array
  plots = [];
}
// ***** END OPTION: FREE DRAW SUPPORT *****
</script>